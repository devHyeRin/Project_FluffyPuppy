<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">

<head>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
</head>

<!-- page css -->
<th:block layout:fragment="css">
    <link th:href="@{/css/cart/cart.css}" rel="stylesheet">
</th:block>

<!-- page js -->
<th:block layout:fragment="script">
    <script th:src="@{/js/cart/cart.js}"></script>
</th:block>

<div layout:fragment="content">
    <div class="cart-wrap">

        <!-- title -->
        <div class="cart-header">
            <h2 class="cart-title">
                장바구니
                <span class="material-symbols-outlined">add_shopping_cart</span>
            </h2>

            <ul class="breadcrumb">
                <li><a href="/"><span class="material-symbols-outlined">home</span></a></li>
                <li><span class="material-symbols-outlined">arrow_forward_ios</span></li>
                <li>장바구니</li>
            </ul>
        </div>

        <!-- table -->
        <table class="table cart-table">
            <thead>
            <tr class="text-center">
                <th><input type="checkbox" id="checkall"></th>
                <th>상품이미지</th>
                <th>상품명</th>
                <th>가격</th>
                <th>수량</th>
                <th>총 금액</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="cartItem : ${cartItems}">
                <td class="text-center align-middle">
                    <input type="checkbox"
                           name="cartChkBox"
                           th:value="${cartItem.cartItemId}">
                </td>

                <td>
                    <img th:src="${cartItem.imgUrl}"
                         class="repImg"
                         th:alt="${cartItem.itemNm}">
                </td>

                <td class="text-center align-middle">
                    <span th:text="${cartItem.itemNm}"></span>
                </td>

                <td class="text-center align-middle">
                    <span th:id="'price_' + ${cartItem.cartItemId}"
                          th:data-price="${cartItem.price}"
                          th:text="${cartItem.price}"
                          class="item-price"></span>
                </td>

                <td class="text-center align-middle">
                    <input type="number"
                           th:id="'count_' + ${cartItem.cartItemId}"
                           th:value="${cartItem.count}"
                           min="1"
                           class="form-control count-input">
                </td>

                <td class="text-center align-middle">
                    <span th:id="'totalPrice_' + ${cartItem.cartItemId}"
                          th:text="${cartItem.price * cartItem.count}"
                          class="item-price text-danger"></span>
                </td>
            </tr>
            </tbody>
        </table>

        <!-- total -->
        <div class="total-price-section">
            <h3 class="total-price">
                총 주문 금액 :
                <span id="orderTotalPrice">0원</span>
            </h3>
        </div>

        <!-- buttons -->
        <div class="cart-actions">
            <button class="btn btn-outline-secondary" onclick="deleteSelected()">
                선택 상품 삭제
            </button>
            <button class="btn btn-primary" onclick="orders()">
                주문하기
            </button>
        </div>

    </div>
</div>
</html>
